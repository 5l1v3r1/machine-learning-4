#!/bin/bash

# @web_scss: is executed from 'bash_loader', which is why the directory
#            paths seem shorter in this file (i.e. missing extra '../').


# Pre-Pathing: allow 'sass' command
PATH="/usr/local/bin:$PATH"


# create directory if doesn't exist
mkdir -p ../html/machine-learning/asset/css/


# track execution of script
set -x; exec > log/bash_web_scss 2>&1


# watch '../src/scss/' subdirectory
inotifywait ../src/scss/ -m -e close_write -e move -e create |
  # Compile CSS
  while read path action file; do
    # filename (without extension)
    filename_full="${file##*/}"
    filename="${filename_full##*/}"

    # compile with 'sass'
    sass ../src/scss/"$file" ../html/machine-learning/asset/css/"$filename".min.css --style compressed
  done
